# BL99x
BL99x - библиотека Arduino для отправки данных на часы/метеостанции, имитируя датчики BL990 и BL999

 >[!IMPORTANT]
**Для использования библиотеки необходим передатчик с частотой передачи 433МГц**  
Передатчик подключается к любому пину Ардуино.

## Протоколы

## BL990

Данный протокол я расшифровал сам, используя подключение к датчику температры и инструмент библиотеки rc-switch (https://test.sui.li/oszi/).

Пакет данных состоит из 28 бит и имеет следующую структуру:

|1001|0000 0000|1110 0011 1000|11|1|1|
|:-:|:-:|:-:|:-:|:-:|:-:|
|контрольная сумма|ID|температура|номер канала|батарея|сигнал при приёме|

Контрольная сумма вычисляется как младший разряд суммы всех полубайт - 1.

Часы/метеостанции принимают сигнал в любое время, то есть можно слать изменение температуры сразу после её измерения.  

## BL999

Протокол подробно описан в библиотеке https://github.com/sprilukin/lib_BL999

Часы/метеостанции принимают сигнал периодами, зависящими от выбранного канала.  
1 канал - 32 секунды  
2 канал - 33 секунды  
3 канал - 34 секунды  
Если по какой-то причине сигнал не был принят, приём начинает осуществлятся со сдвигом вверх на одну секунду, в результате чего в течении некоторого времени передача и приём синхронизируются.

**Для чего нужен ID?**

ID используется для приёма сигнала именно того датчика, который был привязан изначально.  
Используя это, можно вещать неограниченным количеством датчиков (учитвая, что одна передача занимает около 400мс).  
Например, имеется две метеостанции и есть необзодимость передавать 6 параметров, по 3 на каждую. Назначаем каждому датчику свой ID:  
1 датчик - канал 1, ID 1  
2 датчик - канал 2, ID 2  
3 датчик - канал 3, ID 3  
4 датчик - канал 1, ID 4  
5 датчик - канал 2, ID 5  
6 датчик - канал 3, ID 6  
Запускаем на первой метеостанции сброс/поиск датчиков(длительным зажатием кнопки Channel) и отправляем данные первых трёх датчиков.  
Запускаем на второй метеостанции сброс/поиск датчиков и отправляем данные 4, 5 и 6го датчиков.  
В итоге первая метеостанция будет показывать сигнал первых трех датчиков, а вторая - вторых.

## Библиотека

Библиотека устанавливается станадртным для всех библиотек Arduino способом - rопируется в папку с библиотеками Arduino IDE.
Описание использования приведено в файле примера.
